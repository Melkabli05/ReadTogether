import{a as v,b as w}from"./chunk-PMCC7NH4.js";import{O as y,T as g}from"./chunk-24QFR54W.js";import{i as o}from"./chunk-ODN5LVDJ.js";var e={alex:"b1a2c3d4-e5f6-7890-1234-56789abcdef0",sara:"c2b3d4e5-f6a7-8901-2345-6789abcdef01",john:"d3c4e5f6-a7b8-9012-3456-789abcdef012",noavatar:"e4d5f6a7-b8c9-0123-4567-89abcdef0123",maria:"f5e6d7c8-b9a0-1234-5678-9abcdef01234",luc:"a2b3c4d5-e6f7-8901-2345-6789abcdef02",emily:"b3c4d5e6-f7a8-9012-3456-789abcdef013",sven:"c4d5e6f7-a8b9-0123-4567-89abcdef0145"},c={club1:"a1b2c3d4-e5f6-7890-1234-56789abcdef0",club2:"b2c3d4e5-f6a7-8901-2345-6789abcdef01",club3:"c3d4e5f6-a7b8-9012-3456-789abcdef012",club4:"d4e5f6a7-b8c9-0123-4567-89abcdef0123",club5:"e5f6a7b8-c9d0-1234-5678-9abcdef01234",club6:"f6a7b8c9-d0e1-2345-6789-abcdef012345"},l={room1:"a1b2c3d4-e5f6-7890-1234-56789abcdef0",room2:"b2c3d4e5-f6a7-8901-2345-6789abcdef01",room3:"c3d4e5f6-a7b8-9012-3456-789abcdef012",room4:"d4e5f6a7-b8c9-0123-4567-89abcdef0123"},d={text1:"a1b2c3d4-e5f6-7890-1234-56789abcdef0",text2:"b2c3d4e5-f6a7-8901-2345-6789abcdef01",text3:"c3d4e5f6-a7b8-9012-3456-789abcdef012",text4:"d4e5f6a7-b8c9-0123-4567-89abcdef0123",text5:"e5f6a7b8-c9d0-1234-5678-9abcdef01234"},K=[{id:e.alex,username:"alex",display_name:"Alex Smith",profile_picture_url:"",bio:"Language enthusiast",email:"alex@example.com",created_at:new Date("2024-01-01T10:00:00Z"),reading_interests:["Spanish","Literature"],languages:[{language_code:"es",proficiency:"Fluent"}],followers:[e.sara],following:[e.sara],blocked_users:[],is_online:!0,last_active:new Date("2024-01-01T12:00:00Z"),badge:null,badge_description:null,stats:{stages_hosted:2,kudos_received:10,partners_read_with:5}},{id:e.sara,username:"sara",display_name:"Sara Lee",profile_picture_url:"https://randomuser.me/api/portraits/women/65.jpg",bio:"Poetry lover and French speaker",email:"sara@example.com",created_at:new Date("2024-01-02T10:00:00Z"),reading_interests:["Poetry","French"],languages:[{language_code:"fr",proficiency:"Native"}],followers:[e.alex],following:[e.alex],blocked_users:[],is_online:!0,last_active:new Date("2024-01-02T12:00:00Z"),badge:null,badge_description:null,stats:{stages_hosted:1,kudos_received:5,partners_read_with:3}},{id:e.john,username:"john",display_name:"John Doe",profile_picture_url:"https://randomuser.me/api/portraits/men/32.jpg",bio:"Avid reader and club founder",email:"john@example.com",created_at:new Date("2024-01-03T10:00:00Z"),reading_interests:["Novels","History"],languages:[{language_code:"en",proficiency:"Fluent"}],followers:[],following:[],blocked_users:[],is_online:!0,last_active:new Date("2024-01-03T12:00:00Z"),badge:null,badge_description:null,stats:{stages_hosted:3,kudos_received:8,partners_read_with:7}},{id:e.noavatar,username:"noavatar",display_name:"No Avatar",profile_picture_url:"",bio:"",email:"noavatar@example.com",created_at:new Date("2024-01-04T10:00:00Z"),reading_interests:[],languages:[{language_code:"de",proficiency:"Learning"}],followers:[],following:[],blocked_users:[],is_online:!1,last_active:null,badge:null,badge_description:null,stats:{stages_hosted:0,kudos_received:0,partners_read_with:0}}],T={id:e.maria,username:"maria",display_name:"Maria Garcia",profile_picture_url:"https://randomuser.me/api/portraits/women/44.jpg",bio:"Spanish literature expert",email:"maria@example.com",created_at:new Date,reading_interests:["Spanish","Literature"],languages:[{language_code:"es",proficiency:"fluent"}],followers:[],following:[],blocked_users:[],stats:{stages_hosted:5,kudos_received:20,partners_read_with:15}},x={id:e.luc,username:"luc",display_name:"Luc Moreau",profile_picture_url:"https://randomuser.me/api/portraits/men/45.jpg",bio:"French poetry enthusiast",email:"luc@example.com",created_at:new Date,reading_interests:["Poetry","French"],languages:[{language_code:"fr",proficiency:"native"}],followers:[],following:[],blocked_users:[],is_online:!0,stats:{stages_hosted:2,kudos_received:12,partners_read_with:9}},S={id:e.emily,username:"emily",display_name:"Emily Clark",profile_picture_url:"https://randomuser.me/api/portraits/women/68.jpg",bio:"History buff and discussion leader",email:"emily@example.com",created_at:new Date,reading_interests:["History","Discussion"],languages:[{language_code:"en",proficiency:"fluent"}],followers:[],following:[],blocked_users:[],is_online:!0,stats:{stages_hosted:4,kudos_received:15,partners_read_with:10}},A={id:e.sven,username:"sven",display_name:"Sven M\xFCller",profile_picture_url:"https://randomuser.me/api/portraits/men/77.jpg",bio:"German literature and philosophy",email:"sven@example.com",created_at:new Date,reading_interests:["Philosophy","German"],languages:[{language_code:"de",proficiency:"native"}],followers:[],following:[],blocked_users:[],is_online:!0,stats:{stages_hosted:2,kudos_received:3,partners_read_with:2}},U=[{id:l.room1,title:"Spanish Literature Club",description:"Reading classic Spanish novels together.",status:"Live",text_content_id:d.text1,language:"es",book_club_id:c.club1,hosts:[e.alex,e.sara],current_reader_id:e.alex,current_position:{paragraph_index:0,word_index:0},reading_order:[e.alex,e.sara],audience_count:12,scheduled_time:new Date("2024-02-01T18:00:00Z"),start_time:new Date("2024-02-01T18:05:00Z"),end_time:null,tags:["Classic","Literature"]},{id:l.room2,title:"French Poetry Circle",description:"Exploring modern French poetry with pronunciation practice.",status:"live",text_content_id:d.text2,language:"fr",hosts:[x],current_reader_id:e.luc,current_position:{paragraph_index:0,word_index:0},audience_count:8,scheduled_time:new Date(Date.now()+3600*1e3),tags:["Poetry","French"],reading_order:[e.luc],reading_turns:[{user_id:e.luc,started_at:new Date,paragraphs_read:1}],start_time:new Date(Date.now()-1800*1e3),end_time:void 0,book_club_id:c.club3},{id:l.room3,title:"History Buffs",description:"Dive into world history with engaging discussions.",status:"live",text_content_id:d.text3,language:"en",hosts:[S],current_reader_id:e.emily,current_position:{paragraph_index:0,word_index:0},audience_count:15,scheduled_time:new Date(Date.now()+7200*1e3),tags:["History","Discussion"],reading_order:[e.emily],reading_turns:[{user_id:e.emily,started_at:new Date,paragraphs_read:2}],start_time:new Date(Date.now()-1200*1e3),end_time:void 0,book_club_id:c.club2},{id:l.room4,title:"German Philosophy Night",description:"Discussing Kant and Nietzsche in the original language.",status:"live",text_content_id:d.text4,language:"de",hosts:[A],current_reader_id:e.sven,current_position:{paragraph_index:0,word_index:0},audience_count:3,scheduled_time:new Date(Date.now()+3600*1e3*5),tags:["Philosophy","German"],reading_order:[e.sven],reading_turns:[{user_id:e.sven,started_at:new Date,paragraphs_read:1}],start_time:new Date(Date.now()-600*1e3),end_time:void 0,book_club_id:c.club4}],Z=[{id:"4",title:"Modern Novels Meetup",description:"Discussing the latest in modern literature.",status:"scheduled",text_content_id:"book4",language:"English",hosts:[S],current_reader_id:void 0,current_position:{paragraph_index:0,word_index:0},audience_count:10,scheduled_time:new Date(Date.now()+10800*1e3),tags:["Novels","Modern"]},{id:"5",title:"Latin American Short Stories",description:"A journey through Latin American short fiction.",status:"scheduled",text_content_id:"book5",language:"Spanish",hosts:[T],current_reader_id:void 0,current_position:{paragraph_index:0,word_index:0},audience_count:7,scheduled_time:new Date(Date.now()+14400*1e3),tags:["Short Stories","Latin America"]},{id:"6",title:"French Classics Revisited",description:"Rediscovering the classics of French literature.",status:"scheduled",text_content_id:"book6",language:"French",hosts:[x],current_reader_id:void 0,current_position:{paragraph_index:0,word_index:0},audience_count:9,scheduled_time:new Date(Date.now()+18e3*1e3),tags:["Classics","French"]},{id:"7",title:"Empty Event",description:"",status:"scheduled",text_content_id:"",language:"",hosts:[],current_reader_id:void 0,current_position:{paragraph_index:0,word_index:0},audience_count:0,scheduled_time:new Date(Date.now()+3600*1e3*24),tags:[]}],q=[{id:d.text1,title:"Cien a\xF1os de soledad",author:"Gabriel Garc\xEDa M\xE1rquez",content:"",type:"Book",genre:"Classic",reading_level:"advanced",cover_image_url:"",uploader_id:e.alex,is_public_domain:!1,word_count:1e5,estimated_reading_time:null,rating:null},{id:d.text2,title:"Les Fleurs du mal",author:"Charles Baudelaire",content:"",type:"Book",genre:"Poetry",reading_level:"advanced",cover_image_url:"",uploader_id:e.luc,is_public_domain:!0,word_count:5e4,estimated_reading_time:null,rating:null},{id:d.text3,title:"A Brief History of Time",author:"Stephen Hawking",content:"",type:"book",genre:"History",reading_level:"intermediate",cover_image_url:"",uploader_id:e.emily,is_public_domain:!1,word_count:6e4},{id:d.text4,title:"Also sprach Zarathustra",author:"Friedrich Nietzsche",content:"",type:"book",genre:"Philosophy",reading_level:"advanced",cover_image_url:"",uploader_id:e.sven,is_public_domain:!0,word_count:4e4}],D=[{id:c.club1,name:"Language Buddies",description:"Practice English with friends every week!",cover_image_url:"",owner_id:e.alex,admins:[e.alex],members:[e.alex,e.sara,e.john],is_public:!0,created_at:new Date("2024-01-15T00:00:00Z"),tags:["English","Conversation"],language:"English",weekly_meeting_time:"Saturdays 5pm",genre:"Classic",activity_level:"Very Active",membership_type:"Open",views:1200,likes:89,currently_reading_title:"Pride and Prejudice",currently_reading_author:"Jane Austen",admin_name:"Emily Watson",admin_messages:45,next_meeting:"Tomorrow, 7:00 PM",rating:4.8},{id:c.club2,name:"Sci-Fi Explorers",description:"Explore the universe of science fiction!",cover_image_url:"https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80",owner_id:e.sara,admins:[e.sara],members:[e.sara,e.john],is_public:!1,created_at:new Date("2023-03-22T00:00:00Z"),tags:["Sci-Fi","Movies","Space"],language:"en",weekly_meeting_time:"Fridays 8pm",genre:"Sci-Fi",activity_level:"Active",membership_type:"Approval",views:1450,likes:134,currently_reading_title:"Dune",currently_reading_author:"Frank Herbert",admin_name:"Marcus Chen",admin_messages:67,next_meeting:"Friday, 8:30 PM",rating:4.5},{id:c.club3,name:"Francophone Readers",description:"Pour les amateurs de litt\xE9rature fran\xE7aise. Venez partager vos lectures et auteurs pr\xE9f\xE9r\xE9s.",cover_image_url:"https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",owner_id:e.luc,admins:[e.luc],members:[e.luc,e.emily],is_public:!0,created_at:new Date("2023-05-15"),tags:["Fran\xE7ais","Romans","Culture"],language:"fr",weekly_meeting_time:"Mardis 19h",genre:"Fantasy",activity_level:"Active",membership_type:"Approval",views:1e3,likes:50,currently_reading_title:"Le Petit Prince",currently_reading_author:"Antoine de Saint-Exup\xE9ry",admin_name:"Sofia Rodriguez",admin_messages:32,next_meeting:"Sunday, 6:00 PM"},{id:c.club4,name:"Mystery & Thriller Society",description:"Dive into the world of suspense, crime, and thrillers. Monthly book picks and lively debates!",cover_image_url:"https://images.unsplash.com/photo-1507842217343-583bb7270b66?auto=format&fit=crop&w=400&q=80",owner_id:e.maria,admins:[e.maria,e.luc],members:[e.maria,e.luc,e.emily,e.sara,e.john],is_public:!0,created_at:new Date("2023-06-01"),tags:["Mystery","Thriller","Crime"],language:"en",weekly_meeting_time:"Wednesdays 7pm",genre:"Historical",activity_level:"Active",membership_type:"Approval",views:800,likes:35,currently_reading_title:"The Hound of the Baskervilles",currently_reading_author:"Arthur Conan Doyle",admin_name:"Marcus Chen",admin_messages:67,next_meeting:"Friday, 8:30 PM"},{id:c.club5,name:"C\xEDrculo de Lectura Espa\xF1ol",description:"Un club para lectores hispanohablantes. Compartimos novelas, poes\xEDa y ensayos en espa\xF1ol.",cover_image_url:"https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",owner_id:e.john,admins:[e.john],members:[e.john,e.sara,e.emily],is_public:!1,created_at:new Date("2023-07-12"),tags:["Espa\xF1ol","Novelas","Poes\xEDa"],language:"es",weekly_meeting_time:"S\xE1bados 18:00",genre:"Classic",activity_level:"Active",membership_type:"Approval",views:800,likes:35,currently_reading_title:"The Hound of the Baskervilles",currently_reading_author:"Arthur Conan Doyle",admin_name:"Marcus Chen",admin_messages:67,next_meeting:"Friday, 8:30 PM"},{id:c.club6,name:"Young Adult Bookworms",description:"For fans of YA fiction! Join us for fun discussions, themed events, and buddy reads.",cover_image_url:"https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=400&q=80",owner_id:e.john,admins:[e.john],members:[e.john,e.sara,e.emily],is_public:!0,created_at:new Date("2023-08-05"),tags:["YA","Fiction","Events"],language:"en",weekly_meeting_time:"Mondays 6pm",genre:"Fiction",activity_level:"Active",membership_type:"Approval",views:800,likes:35,currently_reading_title:"The Hound of the Baskervilles",currently_reading_author:"Arthur Conan Doyle",admin_name:"Marcus Chen",admin_messages:67,next_meeting:"Friday, 8:30 PM"}],G=[{id:"reading-turn-uuid-1",room_id:l.room1,user_id:e.alex,started_at:new Date("2024-02-01T18:05:00Z"),ended_at:null,paragraphs_read:3}],z=[{id:"reaction-uuid-1",stage_id:l.room1,author_id:e.alex,emoji:"\u{1F44D}",timestamp:new Date("2024-02-01T18:10:00Z"),target_paragraph_index:1}],J=[{id:"annotation-uuid-1",room_id:l.room1,author_id:e.alex,type:"note",text:"Interesting phrase!",target_word:null,position:{start:10,end:20},created_at:new Date("2024-02-01T18:12:00Z"),resolved:!1}],Y=[{id:"notif-uuid-1",type:"invitation",from_user:e.alex,message:"You have been invited to join Language Buddies!",link:"/clubs/club-uuid-1",is_read:!1,created_at:new Date("2024-02-01T18:15:00Z"),is_archived:!1}],$=[{id:"msg-uuid-1",context_id:l.room1,author:e.alex,content:"Hello everyone!",timestamp:new Date("2024-02-01T18:20:00Z"),type:"text"}],V=[{user_id:e.alex,room_id:l.room1,role:"audience",joined_at:new Date("2024-02-01T18:00:00Z")}];function m(a){return{id:a.id,name:a.name,description:a.description,coverImageUrl:a.cover_image_url,ownerId:a.owner_id,isPublic:a.is_public,language:a.language,genre:a.genre,tags:a.tags,weeklyMeetingTime:a.weekly_meeting_time,activityLevel:a.activity_level,membershipType:a.membership_type,createdAt:a.created_at?new Date(a.created_at):new Date(0),updatedAt:a.updated_at?new Date(a.updated_at):new Date(0),views:a.views,likes:a.likes,rating:a.rating,currentlyReadingTitle:a.currently_reading_title,currentlyReadingAuthor:a.currently_reading_author,nextMeeting:a.next_meeting?new Date(a.next_meeting):void 0,memberCount:a.member_count}}var p=9e4,E=a=>{let t=0;for(let r=0;r<a.length;r++){let i=a.charCodeAt(r);t=(t<<5)-t+i,t&=t}return t.toString()},C=class a{supabase=g(v);cacheService=g(w);getClubs(t){return o(this,null,function*(){let r=`clubs:${E(JSON.stringify(t??{}))}`,i=this.cacheService.get(r);if(i&&!(new Date().getTime()-i.timestamp>p))return i.response;let s=t?.page??1,u=t?.pageSize??12,_=(s-1)*u,h=_+u-1,n=this.supabase.supabase.from("clubs").select("*",{count:"exact"}).range(_,h);if(t?.search&&(n=n.textSearch("fts",t.search,{type:"plain"})),t?.languages?.length&&(n=n.in("language",t.languages)),t?.genres?.length&&(n=n.in("genre",t.genres)),t?.types?.length&&(t.types.includes("Public")&&!t.types.includes("Private")?n=n.eq("is_public",!0):!t.types.includes("Public")&&t.types.includes("Private")&&(n=n.eq("is_public",!1))),t?.activity?.length&&(n=n.in("activity_level",t.activity)),t?.membershipTypes?.length&&(n=n.in("membership_type",t.membershipTypes)),t?.joinedOnly&&t.userId,t?.sortBy)switch(t.sortBy){case"most-members":n=n.order("member_count",{ascending:!1});break;case"recently-active":case"newest":n=n.order("created_at",{ascending:!1});break;case"az":n=n.order("name",{ascending:!0});break;case"best-match":default:break}let{data:k,error:b,count:M}=yield n;if(b)throw b;let f={clubs:(k??[]).map(m),total:M??0};return this.cacheService.set(r,f),f})}getClub(t){return o(this,null,function*(){let r=`club:${t}`,i=this.cacheService.get(r);if(i&&!(new Date().getTime()-i.timestamp>p))return i.response;let{data:s,error:u}=yield this.supabase.supabase.from("clubs").select("*").eq("id",t).single();if(u)throw u;let _=s?m(s):null;return this.cacheService.set(r,_),_})}createClub(t){return o(this,null,function*(){this.cacheService.clear();let{data:r,error:i}=yield this.supabase.supabase.from("clubs").insert([t]).select().single();if(i)throw i;return m(r)})}updateClub(t,r){return o(this,null,function*(){this.cacheService.clear();let{data:i,error:s}=yield this.supabase.supabase.from("clubs").update(r).eq("id",t).select().single();if(s)throw s;return m(i)})}deleteClub(t){return o(this,null,function*(){this.cacheService.clear();let{error:r}=yield this.supabase.supabase.from("clubs").delete().eq("id",t);if(r)throw r})}getClubMembers(t){return o(this,null,function*(){let r=`club-members:${t}`,i=this.cacheService.get(r);if(i&&!(new Date().getTime()-i.timestamp>p))return i.response;let{data:s,error:u}=yield this.supabase.supabase.from("club_members").select("*").eq("club_id",t);return this.cacheService.set(r,s),s})}addClubMember(t,r){return o(this,null,function*(){this.cacheService.clear();let{data:i,error:s}=yield this.supabase.supabase.from("club_members").insert({club_id:t,member_id:r});return i})}removeClubMember(t,r){return o(this,null,function*(){this.cacheService.clear();let{data:i,error:s}=yield this.supabase.supabase.from("club_members").delete().eq("club_id",t).eq("member_id",r);return i})}getClubEvents(t){return o(this,null,function*(){let r=`club-events:${t}`,i=this.cacheService.get(r);if(i&&!(new Date().getTime()-i.timestamp>p))return i.response;let{data:s,error:u}=yield this.supabase.supabase.from("club_events").select("*").eq("club_id",t);return this.cacheService.set(r,s),s})}seedClubs(){return o(this,null,function*(){this.cacheService.clear();for(let t of D)yield this.createClub(t)})}static \u0275fac=function(r){return new(r||a)};static \u0275prov=y({token:a,factory:a.\u0275fac,providedIn:"root"})};export{C as a};
