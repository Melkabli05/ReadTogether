import{a as B,b as A}from"./chunk-UULC334K.js";import{a as L,f as H,h as F,j as P,y as z}from"./chunk-5KZPAB2C.js";import{c as $,d as j}from"./chunk-BW2BEZL2.js";import{Cb as f,Ma as r,Rb as d,Sb as y,T as _,Tb as g,Xa as U,bc as T,ca as b,ga as w,hc as D,jc as k,kb as I,mb as h,nb as x,ob as E,pb as C,pc as s,qb as S,qc as v,rb as u,sb as o,tb as a,tc as N,ub as p}from"./chunk-24QFR54W.js";import{a as m,b as c}from"./chunk-ODN5LVDJ.js";var O=i=>({"ring-2 ring-green-300 shadow-green-100":i}),V=(i,n)=>n.id;function W(i,n){if(i&1&&p(0,"img",3),i&2){let e,t,l=f();u("ngSrc",((e=l.hostUser())==null?null:e.profilePictureUrl)??"")("alt",((t=l.hostUser())==null?null:t.displayName)??"Host")}}function q(i,n){if(i&1&&(o(0,"span",4),d(1),a()),i&2){let e,t,l=f();u("title",((e=l.hostUser())==null?null:e.displayName)??"Host"),r(),g(" ",((t=l.hostUser())==null||t.displayName==null?null:t.displayName.charAt(0))??"U"," ")}}function J(i,n){if(i&1&&p(0,"img",22),i&2){let e,t,l=f(2);u("ngSrc",((e=l.resolvedCurrentReader())==null?null:e.profilePictureUrl)??"")("alt",((t=l.resolvedCurrentReader())==null?null:t.displayName)??"Current Reader")}}function G(i,n){i&1&&(o(0,"span",25),d(1,"(Host)"),a())}function K(i,n){if(i&1&&(o(0,"div",10),h(1,J,1,2,"img",22),o(2,"span",23),d(3),a(),p(4,"i",24),h(5,G,2,0,"span",25),a()),i&2){let e,t,l=f();r(),x((e=l.resolvedCurrentReader())!=null&&e.profilePictureUrl?1:-1),r(2),y(((t=l.resolvedCurrentReader())==null?null:t.displayName)??"Unknown"),r(2),x(l.isHostCurrentReader()?5:-1)}}function Q(i,n){if(i&1&&(o(0,"div",11),p(1,"i",26),o(2,"span",27),d(3),D(4,"date"),a()()),i&2){let e=f();r(3),g("Starts at ",k(4,1,e.room().scheduledTime,"shortTime"))}}function X(i,n){if(i&1&&p(0,"img",28),i&2){let e=f().$implicit;u("ngSrc",e.profilePictureUrl)("alt",e.displayName)("title",e.displayName)}}function Y(i,n){if(i&1&&(o(0,"span",29),d(1),a()),i&2){let e=f().$implicit;u("title",e.displayName),r(),g(" ",e.displayName?e.displayName.charAt(0):e.username?e.username.charAt(0):"?"," ")}}function Z(i,n){if(i&1&&h(0,X,1,3,"img",28)(1,Y,2,2,"span",29),i&2){let e=n.$implicit;x(e.profilePictureUrl?0:1)}}function ee(i,n){if(i&1&&(o(0,"span",30),d(1),a()),i&2){let e=n.$implicit;r(),g(" ",e," ")}}function te(i,n){if(i&1&&(o(0,"div",20),C(1,ee,2,1,"span",30,E),a()),i&2){let e=f();r(),S(e.room().tags)}}var M=class i{room=N.required();RoomStatus=$;userService=_(j);roomService=_(B);textService=_(A);destroyRef=_(b);_cardData=w({hosts:[],textContent:void 0,currentReader:void 0});resolvedHosts=s(()=>this._cardData().hosts);resolvedTextContent=s(()=>this._cardData().textContent);resolvedCurrentReader=s(()=>this._cardData().currentReader);hostUser=s(()=>this.resolvedHosts()[0]);isHostCurrentReader=s(()=>this.room().currentReaderId===this.hostUser()?.id);statusLabel=s(()=>ie(this.room().status));statusBadgeClass=s(()=>({"bg-green-100 text-green-700":this.room().status==="live","bg-yellow-100 text-yellow-700":this.room().status==="scheduled","bg-gray-100 text-gray-600":this.room().status==="ended","bg-red-100 text-red-700":this.room().status==="cancelled"}));actionLabel=s(()=>ne(this.room().status));actionIcon=s(()=>{let n=this.room().status;return n==="live"?"pi pi-microphone":n==="scheduled"?"pi pi-sign-in":null});actionSeverity=s(()=>{let n=this.room().status;return n==="live"||n==="scheduled"?"primary":"secondary"});isOutlined=s(()=>this.room().status!=="live");constructor(){this.setupEffects()}setupEffects(){v(()=>{let n=this.room().id;this.roomService.getRoomHosts(n).then(e=>{let t=e.map(l=>l.userId);return this.userService.getUsersByIds(t)}).then(e=>{this._cardData.update(t=>c(m({},t),{hosts:e}))}).catch(e=>{console.error("Failed to fetch room hosts:",e),this._cardData.update(t=>c(m({},t),{hosts:[]}))})}),v(()=>{let n=this.room().textContentId;n?this.textService.getTextContentTitle(n).then(e=>{this._cardData.update(t=>c(m({},t),{textContent:e??void 0}))}).catch(e=>{console.error("Failed to fetch text content:",e),this._cardData.update(t=>c(m({},t),{textContent:void 0}))}):this._cardData.update(e=>c(m({},e),{textContent:void 0}))}),v(()=>{let n=this.room().currentReaderId;n?this.userService.getUser(n).then(e=>{this._cardData.update(t=>c(m({},t),{currentReader:e??void 0}))}).catch(e=>{console.error("Failed to fetch current reader:",e),this._cardData.update(t=>c(m({},t),{currentReader:void 0}))}):this._cardData.update(e=>c(m({},e),{currentReader:void 0}))})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=U({type:i,selectors:[["app-room-card"]],inputs:{room:[1,"room"]},decls:34,vars:22,consts:[["tabindex","0","role","article",1,"rounded-2xl","p-4","sm:p-5","bg-white","shadow-md","border","border-gray-100","transition-all","duration-200","hover:shadow-lg","cursor-pointer","flex","flex-col","gap-3","w-full","min-h-[27rem]","h-[27rem]",3,"ngClass"],[1,"flex","justify-between","items-start"],[1,"flex","items-center","gap-3","min-w-0","flex-1"],["width","40","height","40","priority","low",1,"w-10","h-10","rounded-full","border","border-gray-200","shadow-sm","flex-shrink-0",3,"ngSrc","alt"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-full","bg-gray-300","text-gray-600","border","border-gray-200","text-lg","font-bold","flex-shrink-0",3,"title"],[1,"min-w-0","flex-1"],[1,"text-base","font-semibold","text-gray-800","truncate"],[1,"text-xs","text-gray-500","truncate"],[1,"text-xs","px-2","py-0.5","rounded-full","font-medium","flex-shrink-0","ml-2",3,"ngClass"],[1,"text-sm","text-gray-600","line-clamp-2","min-h-[2rem]","flex-shrink-0"],[1,"flex","items-center","gap-2","bg-green-50","border","border-green-200","rounded-lg","p-2","flex-shrink-0"],[1,"flex","items-center","gap-2","bg-yellow-50","border","border-yellow-200","rounded-lg","p-2","flex-shrink-0"],[1,"flex","flex-wrap","gap-2","mt-1","text-xs","text-gray-700","flex-shrink-0"],[1,"flex","items-center","gap-1"],[1,"pi","pi-users"],[1,"pi","pi-globe"],[1,"text-sm","text-gray-800","flex-shrink-0"],[1,"font-medium"],[1,"truncate"],[1,"flex","items-center","-space-x-3","mt-2","flex-shrink-0"],[1,"flex","flex-wrap","gap-1","mt-2","flex-shrink-0"],[1,"mt-auto",3,"label","icon","severity","outlined","size","fullWidth"],["width","32","height","32","priority","low",1,"w-6","h-6","sm:w-8","sm:h-8","rounded-full","border-white","shadow-sm","flex-shrink-0",3,"ngSrc","alt"],[1,"text-green-700","font-medium","text-sm","truncate"],[1,"pi","pi-microphone","text-green-700","text-sm","flex-shrink-0"],[1,"text-xs","text-green-600","ml-1","flex-shrink-0"],[1,"pi","pi-clock","text-yellow-700","flex-shrink-0"],[1,"text-sm","text-yellow-800"],["width","24","height","24","priority","low",1,"w-6","h-6","rounded-full","border-2","border-white","shadow-sm",3,"ngSrc","alt","title"],[1,"w-6","h-6","flex","items-center","justify-center","rounded-full","bg-gray-300","text-gray-600","border-2","border-white","text-xs","font-bold",3,"title"],[1,"px-2","py-0.5","rounded","bg-blue-100","text-blue-700","text-xs","font-medium"]],template:function(e,t){if(e&1&&(o(0,"article",0)(1,"div",1)(2,"div",2),h(3,W,1,2,"img",3)(4,q,2,2,"span",4),o(5,"div",5)(6,"h3",6),d(7),a(),o(8,"p",7),d(9),a()()(),o(10,"span",8),d(11),a()(),o(12,"p",9),d(13),a(),h(14,K,6,3,"div",10),h(15,Q,5,4,"div",11),o(16,"div",12)(17,"div",13),p(18,"i",14),d(19),a(),o(20,"div",13),p(21,"i",15),o(22,"span"),d(23),a()()(),o(24,"div",16)(25,"span",17),d(26,"Text:"),a(),o(27,"span",18),d(28),a()(),o(29,"div",19),C(30,Z,2,1,null,null,V),a(),h(32,te,3,0,"div",20),p(33,"app-button",21),a()),e&2){let l,R;u("ngClass",T(20,O,t.room().status===t.RoomStatus.Live)),I("aria-label","Room: "+t.room().title),r(3),x((l=t.hostUser())!=null&&l.profilePictureUrl?3:4),r(4),y(t.room().title),r(2),g("Host: ",((R=t.hostUser())==null?null:R.displayName)??"Unknown"),r(),u("ngClass",t.statusBadgeClass()),r(),g(" ",t.statusLabel()," "),r(2),y(t.room().description),r(),x(t.room().status===t.RoomStatus.Live&&t.resolvedCurrentReader()?14:-1),r(),x(t.room().status===t.RoomStatus.Scheduled?15:-1),r(4),g(" ",t.room().audienceCount," audience "),r(4),y(t.room().language),r(5),y(t.resolvedTextContent()||"Unknown"),r(2),S(t.resolvedHosts()),r(2),x(t.room().tags.length>0?32:-1),r(),u("label",t.actionLabel())("icon",t.actionIcon())("severity",t.actionSeverity())("outlined",t.isOutlined())("size","sm")("fullWidth",!0)}},dependencies:[F,L,H,P,z],encapsulation:2,changeDetection:0})};function ie(i){switch(i){case"live":return"Live";case"scheduled":return"Upcoming";case"ended":return"Ended";case"cancelled":return"Cancelled";default:return""}}function ne(i){switch(i){case"live":return"Join Room";case"scheduled":return"RSVP";case"ended":return"View Recap";default:return"View"}}export{M as a};
